\documentclass[12pt,a4paper]{article}
\usepackage{math-text}
% \usepackage{todonotes}
% \usepackage{multicol}
% \usepackage{float}

\title{Дискретные интегрируемые системы и геометрия.}
\author{Антон Викторович Джамай}

\begin{document}
    \maketitle

    Литература:
    \begin{itemize}
        \item ``Discrete Integrable Systems: QRT Maps and Elliptic Surfaces'' J. J. Duistermaat. (\href{https://www.amazon.com/Discrete-Integrable-Systems-Monographs-Mathematics/dp/1441971165}{Amazon})
    \end{itemize}

    Что такое динамическая система? Это система, которая меняется с течением ``времени''. В непрерывном случае у нас есть конфигурационное пространство $X$, после чего мы рассматриваем некоторое отображение $[0; 1] \to X$ (или $[0; \RR) \to X$), удовлетворяющее определённому дифференциальному уравнению --- функция движения системы. В дискретном случае мы будем рассматривать $\{1; \dots; n\} \to X$ (или $\NN \to X$), которое будет удовлетворять рекурентному соотношению.

    В непрерывном случае мы можем рассматривать
    \begin{itemize}
        \item интегрируемость,
        \item нелинейность,
        \item обратимость.
    \end{itemize}
    Хотим того же для дискретного случая.

    \begin{example}
        Числа Фиббоначчи:
        \[F_0 = 0, \quad F_1 = 1, \quad F_2 = 1, \quad F_3 = 2, \dots\]
        С одной стороны
        \[F_{n+2} = F_{n+1} + F_n.\]
        С другой стороны
        \[
            \begin{pmatrix}
                F_{n+2}\\
                F_{n+1}
            \end{pmatrix}
            =
            \begin{pmatrix}
                1& 1\\
                1& 0
            \end{pmatrix}
            \begin{pmatrix}
                F_{n+1}\\
                F_n
            \end{pmatrix},
        \]
        что указывает на линейность системы.
    \end{example}

    \begin{definition}
        \emph{Отображение QRT (G.R.W. Quisped, L.A.G. Roberts, C. Thompson)}. Пусть есть кривая $\Gamma: p(x, y) = 0$, $\deg_x(p) = \deg_y(p) = 2$ (биквадратный многочлен, $(2, 2)$).

        Чтобы иметь алгебраическую замкнутость, будем сидеть в $\CC^2$, а чтобы не терять корней, будем сидеть в $(\CC P^1)^2$.

        Для всякой точки $(x_0, y_0) \in \Gamma \subseteq (\CC P^1)^2$ можно рассмотреть прямую $l: x = x_0$. Эта прямая пересечёт $\Gamma$ в двух точках: $(x_0, y_0)$ и $(x_0, y_0')$. Таким образом мы получаем инволюцию
        \[r_x: \Gamma \to \Gamma, (x_0, y_0) \mapsto (x_0, y_0');\]
        аналогично определяется $r_y$. Обе $r_x$ и $r_y$ являются инволюциями. Таким образом рассматриваемое отображение QRT будет
        \[\eta := r_y \circ r_x, \qquad \eta: (\CC P^1)^2 \to (\CC P^1)^2, (x_0, y_0) \mapsto (\overline{x_0}, \overline{y_0}).\]
    \end{definition}

    \begin{definition}
        Пусть
        \[p(x, y) = \sum_{d_1, d_2 \in \{0; 1; 2\}} a_{d_1, d_2} x^{d_1} y^{d_2}.\]
        Тогда $p(x, y) = 0$ записывается как
        \[
            \begin{pmatrix}
                1& x& x^2
            \end{pmatrix}
            \begin{pmatrix}
                a_{0,0}& a_{0, 1}& a_{0, 2}\\
                a_{1,0}& a_{1, 1}& a_{1, 2}\\
                a_{2,0}& a_{2, 1}& a_{2, 2}
            \end{pmatrix}
            \begin{pmatrix}
                1\\
                y\\
                y^2
            \end{pmatrix}
            = 0
            \qquad \text{ или } \qquad
            \vec{x}^T A \vec{y} = 0.
        \]
    \end{definition}
    
    \begin{remark}
        Пусть $r_y(x_0, y_0) = (x_0, y_1)$. Тогда по теореме Виета
        \[y_0 + y_1 = \frac{-a_1(x_0)}{a_2(x_0)},\]
        где временно $p(x, y) = a_2(x) y^2 + a_1(x) y + a_0$.
    \end{remark}

    \begin{definition}
        Теперь пусть у нас есть кривые $\Gamma_A$ и $\Gamma_B$ с матрицами $A$ и $B$. Для всякой точки $(x_0, y_0)$, не лежащей не пересечении $\Gamma_A \cap \Gamma_B$ (пересечение в общем случае имеет 8 точек), имеет $\vec{x}_0^T A \vec{y}_0$ и $\vec{x}_0^T B \vec{y}_0$, где одно не равно $0$. Следовательно можно найти их однородную комбинацию равную $0$:
        \[\vec{x}_0^T (\lambda_0 A + \lambda_1 B) \vec{y}_0 = 0, \qquad [\lambda_0: \lambda_1] = [- \vec{x}_0^T B \vec{y}_0: \vec{x}_0^T A \vec{y}_0].\]
        Следовательно можно рассмотреть преобразование почти всего $(\CC P^1)^2$
        \[
            \eta(x_0, y_0)
            = \eta_{\lambda_0 A + \lambda_1 B}(x_0, y_0)
            = \dots
        \]
    \end{definition}

    \begin{remark}
        Поскольку при $\eta$ мы применяем преобразование $\eta_{\lambda_0 A + \lambda_1 B}$, то точка остаётся на кривой, а значит мы остаёмся на той же кривой, а значит значение $[\lambda_0: \lambda_1]$ не меняется и называется \emph{интегралом}.
    \end{remark}

    Lyness map.

    Найдём формулу $\eta$. Обозначим
    \[
        \vec{x}_0^T A =:
        \begin{pmatrix}
            a_0(x_0)\\
            a_1(x_0)\\
            a_2(x_0)
        \end{pmatrix},
        \qquad
        \vec{x}_0^T B =:
        \begin{pmatrix}
            b_0(x_0)\\
            b_1(x_0)\\
            b_2(x_0)
        \end{pmatrix}.
    \]
    Напомним, что
    \[
        \lambda_0 = -\vec{x}_0^T B \vec{y}_0 = -(b_0(x_0) + b_1(x_0) y_0 + b_2(x_0) y_0^2),
        \qquad
        \lambda_1 = \vec{x}_0^T A \vec{y}_0 = (a_0(x_0) + a_1(x_0) y_0 + a_2(x_0) y_0^2).
    \]
    Значит, если $r_y(x_0, y_0) = (x_0, y_1)$, то $y_0$ и $y_1$ суть корни
    \[\lambda_0 \vec{x}_0^T A \vec{y} + \lambda_1 \vec{x}_0^T B \vec{y} = 0.\]
    Переписывая выражение, получаем
    \begin{gather*}
        \begin{aligned}
            - (b_0(x_0) + b_1(x_0) y_0 + b_2(x_0) y_0^2)& (a_0(x_0) + a_1(x_0) y + a_2(x_0) y^2)\\
            &+ (a_0(x_0) + a_1(x_0) y_0 + a_2(x_0) y_0^2) (b_0(x_0) + b_1(x_0) y + b_2(x_0) y^2) = 0
        \end{aligned}\\
        \begin{aligned}
            &((b_0 a_1 - a_0 b_1) y_0 + (a_2 b_0 - a_0 b_2) y_0^2)\\
            {}+& ((a_0 b_1 - a_1 b_0) + (a_2 b_1 - a_1 b_2) y_0^2) y\\
            {}+& ((b_2 a_0 - a_0 b_2) + (a_1 b_2 - a_2 b_1) y_0) y^2 = 0
        \end{aligned}\\
        (f_1 y_0^2 - f_2 y_0) + (f_2 - f_0 y_0^2) y + (f_0 y_0 - f_1) y^2 = 0.\\
        (f \times \vec{y}_0) \vec{y} = 0.
    \end{gather*}
    где
    \[
        (f_0; f_1; f_2) = f := (\vec{x}_0^T A) \times (\vec{x}_0^T B) = \left(
            \begin{vmatrix}
                a_1& a_2\\
                b_1& b_2\\
            \end{vmatrix};
            \begin{vmatrix}
                a_2& a_0\\
                b_2& b_0\\
            \end{vmatrix};
            \begin{vmatrix}
                a_0& a_1\\
                b_0& b_1\\
            \end{vmatrix}
        \right).
    \]
    Таким образом по теореме Безу
    \[y_0 + y_1 = - \frac{f_2 - f_0 y_0^2}{f_0 y_0 - f_1}.\]
    Следовательно,
    \[y_1 = \frac{-f_2 + f_1 y_0}{f_0 y_0 - f_1}.\]

    Пусть
    \[\sigma(x, y, A, B) := (y, x, A^T, B^T).\]
    Тогда
    \[\eta = r_x \circ r_y = \sigma \circ r_y \circ \sigma \circ r_y = (\sigma \circ r_y)^2.\]
    Таким образом можно смотреть на $\sigma \circ r_y$. При этом если $A$ и $B$ симметричны, то $\sigma \circ r_y$ не меняется как отображение от $(x, y)$.
\end{document}